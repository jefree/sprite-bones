var __extends=this.__extends||function(t,i){function e(){this.constructor=t}for(var a in i)i.hasOwnProperty(a)&&(t[a]=i[a]);e.prototype=i.prototype,t.prototype=new e},dragonBones;!function(t){!function(t){var i=function(){function t(t,i){"undefined"==typeof t&&(t=0),"undefined"==typeof i&&(i=0),this.x=t,this.y=i}return t.prototype.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"},t}();t.Point=i;var e=function(){function t(t,i,e,a){"undefined"==typeof t&&(t=0),"undefined"==typeof i&&(i=0),"undefined"==typeof e&&(e=0),"undefined"==typeof a&&(a=0),this.x=t,this.y=i,this.width=e,this.height=a}return t}();t.Rectangle=e;var a=function(){function t(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}return t.prototype.invert=function(){var t=this.a,i=this.b,e=this.c,a=this.d,s=this.tx,r=t*a-i*e;this.a=a/r,this.b=-i/r,this.c=-e/r,this.d=t/r,this.tx=(e*this.ty-a*s)/r,this.ty=-(t*this.ty-i*s)/r},t}();t.Matrix=a;var s=function(){function t(){this.alphaMultiplier=0,this.alphaOffset=0,this.blueMultiplier=0,this.blueOffset=0,this.greenMultiplier=0,this.greenOffset=0,this.redMultiplier=0,this.redOffset=0}return t}();t.ColorTransform=s}(t.geom||(t.geom={}));var i=t.geom;!function(t){var i=function(){function t(t){this.type=t}return t}();t.Event=i;var e=function(t){function i(i){t.call(this,i)}return __extends(i,t),i.FADE_IN="fadeIn",i.FADE_OUT="fadeOut",i.START="start",i.COMPLETE="complete",i.LOOP_COMPLETE="loopComplete",i.FADE_IN_COMPLETE="fadeInComplete",i.FADE_OUT_COMPLETE="fadeOutComplete",i}(i);t.AnimationEvent=e;var a=function(t){function i(i){t.call(this,i)}return __extends(i,t),i.Z_ORDER_UPDATED="zOrderUpdated",i}(i);t.ArmatureEvent=a;var s=function(t){function i(i){t.call(this,i)}return __extends(i,t),i.ANIMATION_FRAME_EVENT="animationFrameEvent",i.BONE_FRAME_EVENT="boneFrameEvent",i}(i);t.FrameEvent=s;var r=function(t){function i(i){t.call(this,i)}return __extends(i,t),i.SOUND="sound",i.BONE_FRAME_EVENT="boneFrameEvent",i}(i);t.SoundEvent=r;var n=function(){function t(){}return t.prototype.hasEventListener=function(t){return this._listenersMap&&this._listenersMap[t]?!0:!1},t.prototype.addEventListener=function(t,i){if(t&&i){this._listenersMap||(this._listenersMap={});var e=this._listenersMap[t];e&&this.removeEventListener(t,i),e?e.push(i):this._listenersMap[t]=[i]}},t.prototype.removeEventListener=function(t,i){if(this._listenersMap&&t&&i){var e=this._listenersMap[t];if(e)for(var a=e.length,s=0;a>s;s++)e[s]==i&&(1==a?(e.length=0,delete this._listenersMap[t]):e.splice(s,1))}},t.prototype.removeAllEventListeners=function(t){t?delete this._listenersMap[t]:this._listenersMap=null},t.prototype.dispatchEvent=function(t){if(t){var i=this._listenersMap[t.type];if(i){t.target=this;for(var e=i.concat(),a=i.length,s=0;a>s;s++)e[s](t)}}},t}();t.EventDispatcher=n;var o=function(t){function i(){if(t.call(this),i._instance)throw new Error("Singleton already constructed!")}return __extends(i,t),i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i}(n);t.SoundEventManager=o}(t.events||(t.events={}));var e=t.events;!function(t){var a=function(){function t(){this.timeScale=1,this.time=.001*(new Date).getTime(),this._animatableList=[]}return t.prototype.contains=function(t){return this._animatableList.indexOf(t)>=0},t.prototype.add=function(t){t&&-1==this._animatableList.indexOf(t)&&this._animatableList.push(t)},t.prototype.remove=function(t){var i=this._animatableList.indexOf(t);i>=0&&(this._animatableList[i]=null)},t.prototype.clear=function(){this._animatableList.length=0},t.prototype.advanceTime=function(t){if(0>t){var i=.001*(new Date).getTime();t=i-this.time,this.time=i}t*=this.timeScale;var e=this._animatableList.length;if(0!=e){for(var a=0,s=0;e>s;s++){var r=this._animatableList[s];r&&(a!=s&&(this._animatableList[a]=r,this._animatableList[s]=null),r.advanceTime(t),a++)}if(a!=s){for(e=this._animatableList.length;e>s;)this._animatableList[a++]=this._animatableList[s++];this._animatableList.length=a}}},t.clock=new t,t}();t.WorldClock=a;var n=function(){function t(){this.transform=new s.DBTransform,this.pivot=new i.Point,this._durationTransform=new s.DBTransform,this._durationPivot=new i.Point,this._durationColor=new i.ColorTransform}return t._borrowObject=function(){return 0==t._pool.length?new t:t._pool.pop()},t._returnObject=function(i){t._pool.indexOf(i)<0&&(t._pool[t._pool.length]=i),i.clear()},t._clear=function(){for(var i=t._pool.length;i--;)t._pool[i].clear();t._pool.length=0},t.getEaseValue=function(i,e){if(e>1){var a=.5*(1-Math.cos(i*Math.PI))-i;e-=1}else e>0?a=Math.sin(i*t.HALF_PI)-i:0>e&&(a=1-Math.cos(i*t.HALF_PI)-i,e*=-1);return a*e+i},t.prototype.fadeIn=function(t,i,e){switch(this._bone=t,this._animationState=i,this._timeline=e,this._originTransform=this._timeline.originTransform,this._originPivot=this._timeline.originPivot,this._tweenTransform=!1,this._tweenColor=!1,this._totalTime=this._animationState.totalTime,this.transform.x=0,this.transform.y=0,this.transform.scaleX=0,this.transform.scaleY=0,this.transform.skewX=0,this.transform.skewY=0,this.pivot.x=0,this.pivot.y=0,this._durationTransform.x=0,this._durationTransform.y=0,this._durationTransform.scaleX=0,this._durationTransform.scaleY=0,this._durationTransform.skewX=0,this._durationTransform.skewY=0,this._durationPivot.x=0,this._durationPivot.y=0,this._currentFrame=null,this._timeline.getFrameList().length){case 0:this._bone._arriveAtFrame(null,this,this._animationState,!1),this._updateState=0;break;case 1:this._updateState=-1;break;default:this._updateState=1}},t.prototype.fadeOut=function(){this.transform.skewX=r.TransformUtil.formatRadian(this.transform.skewX),this.transform.skewY=r.TransformUtil.formatRadian(this.transform.skewY)},t.prototype.update=function(i){if(this._updateState)if(this._updateState>0){0==this._timeline.scale?i=1:i/=this._timeline.scale,1==i&&(i=.99999999),i+=this._timeline.offset;var e=Math.floor(i);i-=e;for(var a,s=this._totalTime*i,n=!1;!this._currentFrame||s>this._currentFramePosition+this._currentFrameDuration||s<this._currentFramePosition;)n&&this._bone._arriveAtFrame(this._currentFrame,this,this._animationState,!0),n=!0,this._currentFrame?(a=this._timeline.getFrameList().indexOf(this._currentFrame)+1,a>=this._timeline.getFrameList().length&&(a=0),this._currentFrame=this._timeline.getFrameList()[a]):(a=0,this._currentFrame=this._timeline.getFrameList()[0]),this._currentFrameDuration=this._currentFrame.duration,this._currentFramePosition=this._currentFrame.position;if(n){this.tweenActive=this._currentFrame.displayIndex>=0,a++,a>=this._timeline.getFrameList().length&&(a=0);var o=this._timeline.getFrameList()[a];0==a&&this._animationState.loop&&this._animationState.loopCount>=Math.abs(this._animationState.loop)-1&&((this._currentFramePosition+this._currentFrameDuration)/this._totalTime+e-this._timeline.offset)*this._timeline.scale>.99999999?(this._updateState=0,this._tweenEasing=0/0):this._tweenEasing=this._currentFrame.displayIndex<0||o.displayIndex<0||!this._animationState.tweenEnabled?0/0:isNaN(this._animationState.clip.tweenEasing)?this._currentFrame.tweenEasing:this._animationState.clip.tweenEasing,isNaN(this._tweenEasing)?(this._tweenTransform=!1,this._tweenColor=!1):(this._durationTransform.x=o.transform.x-this._currentFrame.transform.x,this._durationTransform.y=o.transform.y-this._currentFrame.transform.y,this._durationTransform.skewX=o.transform.skewX-this._currentFrame.transform.skewX,this._durationTransform.skewY=o.transform.skewY-this._currentFrame.transform.skewY,this._durationTransform.scaleX=o.transform.scaleX-this._currentFrame.transform.scaleX,this._durationTransform.scaleY=o.transform.scaleY-this._currentFrame.transform.scaleY,0==a&&(this._durationTransform.skewX=r.TransformUtil.formatRadian(this._durationTransform.skewX),this._durationTransform.skewY=r.TransformUtil.formatRadian(this._durationTransform.skewY)),this._durationPivot.x=o.pivot.x-this._currentFrame.pivot.x,this._durationPivot.y=o.pivot.y-this._currentFrame.pivot.y,this._tweenTransform=0!=this._durationTransform.x||0!=this._durationTransform.y||0!=this._durationTransform.skewX||0!=this._durationTransform.skewY||0!=this._durationTransform.scaleX||0!=this._durationTransform.scaleY||0!=this._durationPivot.x||0!=this._durationPivot.y?!0:!1,this._currentFrame.color&&o.color?(this._durationColor.alphaOffset=o.color.alphaOffset-this._currentFrame.color.alphaOffset,this._durationColor.redOffset=o.color.redOffset-this._currentFrame.color.redOffset,this._durationColor.greenOffset=o.color.greenOffset-this._currentFrame.color.greenOffset,this._durationColor.blueOffset=o.color.blueOffset-this._currentFrame.color.blueOffset,this._durationColor.alphaMultiplier=o.color.alphaMultiplier-this._currentFrame.color.alphaMultiplier,this._durationColor.redMultiplier=o.color.redMultiplier-this._currentFrame.color.redMultiplier,this._durationColor.greenMultiplier=o.color.greenMultiplier-this._currentFrame.color.greenMultiplier,this._durationColor.blueMultiplier=o.color.blueMultiplier-this._currentFrame.color.blueMultiplier,this._tweenColor=0!=this._durationColor.alphaOffset||0!=this._durationColor.redOffset||0!=this._durationColor.greenOffset||0!=this._durationColor.blueOffset||0!=this._durationColor.alphaMultiplier||0!=this._durationColor.redMultiplier||0!=this._durationColor.greenMultiplier||0!=this._durationColor.blueMultiplier?!0:!1):this._currentFrame.color?(this._tweenColor=!0,this._durationColor.alphaOffset=-this._currentFrame.color.alphaOffset,this._durationColor.redOffset=-this._currentFrame.color.redOffset,this._durationColor.greenOffset=-this._currentFrame.color.greenOffset,this._durationColor.blueOffset=-this._currentFrame.color.blueOffset,this._durationColor.alphaMultiplier=1-this._currentFrame.color.alphaMultiplier,this._durationColor.redMultiplier=1-this._currentFrame.color.redMultiplier,this._durationColor.greenMultiplier=1-this._currentFrame.color.greenMultiplier,this._durationColor.blueMultiplier=1-this._currentFrame.color.blueMultiplier):o.color?(this._tweenColor=!0,this._durationColor.alphaOffset=o.color.alphaOffset,this._durationColor.redOffset=o.color.redOffset,this._durationColor.greenOffset=o.color.greenOffset,this._durationColor.blueOffset=o.color.blueOffset,this._durationColor.alphaMultiplier=o.color.alphaMultiplier-1,this._durationColor.redMultiplier=o.color.redMultiplier-1,this._durationColor.greenMultiplier=o.color.greenMultiplier-1,this._durationColor.blueMultiplier=o.color.blueMultiplier-1):this._tweenColor=!1),this._tweenTransform||(this._animationState.blend?(this.transform.x=this._originTransform.x+this._currentFrame.transform.x,this.transform.y=this._originTransform.y+this._currentFrame.transform.y,this.transform.skewX=this._originTransform.skewX+this._currentFrame.transform.skewX,this.transform.skewY=this._originTransform.skewY+this._currentFrame.transform.skewY,this.transform.scaleX=this._originTransform.scaleX+this._currentFrame.transform.scaleX,this.transform.scaleY=this._originTransform.scaleY+this._currentFrame.transform.scaleY,this.pivot.x=this._originPivot.x+this._currentFrame.pivot.x,this.pivot.y=this._originPivot.y+this._currentFrame.pivot.y):(this.transform.x=this._currentFrame.transform.x,this.transform.y=this._currentFrame.transform.y,this.transform.skewX=this._currentFrame.transform.skewX,this.transform.skewY=this._currentFrame.transform.skewY,this.transform.scaleX=this._currentFrame.transform.scaleX,this.transform.scaleY=this._currentFrame.transform.scaleY,this.pivot.x=this._currentFrame.pivot.x,this.pivot.y=this._currentFrame.pivot.y)),this._tweenColor||(this._currentFrame.color?this._bone._updateColor(this._currentFrame.color.alphaOffset,this._currentFrame.color.redOffset,this._currentFrame.color.greenOffset,this._currentFrame.color.blueOffset,this._currentFrame.color.alphaMultiplier,this._currentFrame.color.redMultiplier,this._currentFrame.color.greenMultiplier,this._currentFrame.color.blueMultiplier,!0):this._bone._isColorChanged&&this._bone._updateColor(0,0,0,0,1,1,1,1,!1)),this._bone._arriveAtFrame(this._currentFrame,this,this._animationState,!1)}if((this._tweenTransform||this._tweenColor)&&(i=(s-this._currentFramePosition)/this._currentFrameDuration,this._tweenEasing&&(i=t.getEaseValue(i,this._tweenEasing))),this._tweenTransform){var l=this._currentFrame.transform,h=this._currentFrame.pivot;this._animationState.blend?(this.transform.x=this._originTransform.x+l.x+this._durationTransform.x*i,this.transform.y=this._originTransform.y+l.y+this._durationTransform.y*i,this.transform.skewX=this._originTransform.skewX+l.skewX+this._durationTransform.skewX*i,this.transform.skewY=this._originTransform.skewY+l.skewY+this._durationTransform.skewY*i,this.transform.scaleX=this._originTransform.scaleX+l.scaleX+this._durationTransform.scaleX*i,this.transform.scaleY=this._originTransform.scaleY+l.scaleY+this._durationTransform.scaleY*i,this.pivot.x=this._originPivot.x+h.x+this._durationPivot.x*i,this.pivot.y=this._originPivot.y+h.y+this._durationPivot.y*i):(this.transform.x=l.x+this._durationTransform.x*i,this.transform.y=l.y+this._durationTransform.y*i,this.transform.skewX=l.skewX+this._durationTransform.skewX*i,this.transform.skewY=l.skewY+this._durationTransform.skewY*i,this.transform.scaleX=l.scaleX+this._durationTransform.scaleX*i,this.transform.scaleY=l.scaleY+this._durationTransform.scaleY*i,this.pivot.x=h.x+this._durationPivot.x*i,this.pivot.y=h.y+this._durationPivot.y*i)}this._tweenColor&&(this._currentFrame.color?this._bone._updateColor(this._currentFrame.color.alphaOffset+this._durationColor.alphaOffset*i,this._currentFrame.color.redOffset+this._durationColor.redOffset*i,this._currentFrame.color.greenOffset+this._durationColor.greenOffset*i,this._currentFrame.color.blueOffset+this._durationColor.blueOffset*i,this._currentFrame.color.alphaMultiplier+this._durationColor.alphaMultiplier*i,this._currentFrame.color.redMultiplier+this._durationColor.redMultiplier*i,this._currentFrame.color.greenMultiplier+this._durationColor.greenMultiplier*i,this._currentFrame.color.blueMultiplier+this._durationColor.blueMultiplier*i,!0):this._bone._updateColor(this._durationColor.alphaOffset*i,this._durationColor.redOffset*i,this._durationColor.greenOffset*i,this._durationColor.blueOffset*i,1+this._durationColor.alphaMultiplier*i,1+this._durationColor.redMultiplier*i,1+this._durationColor.greenMultiplier*i,1+this._durationColor.blueMultiplier*i,!0))}else this._updateState=0,this._animationState.blend?(this.transform.copy(this._originTransform),this.pivot.x=this._originPivot.x,this.pivot.y=this._originPivot.y):(this.transform.x=this.transform.y=this.transform.skewX=this.transform.skewY=this.transform.scaleX=this.transform.scaleY=0,this.pivot.x=0,this.pivot.y=0),this._currentFrame=this._timeline.getFrameList()[0],this.tweenActive=this._currentFrame.displayIndex>=0,this._currentFrame.color?this._bone._updateColor(this._currentFrame.color.alphaOffset,this._currentFrame.color.redOffset,this._currentFrame.color.greenOffset,this._currentFrame.color.blueOffset,this._currentFrame.color.alphaMultiplier,this._currentFrame.color.redMultiplier,this._currentFrame.color.greenMultiplier,this._currentFrame.color.blueMultiplier,!0):this._bone._updateColor(0,0,0,0,1,1,1,1,!1),this._bone._arriveAtFrame(this._currentFrame,this,this._animationState,!1)},t.prototype.clear=function(){this._updateState=0,this._bone=null,this._animationState=null,this._timeline=null,this._currentFrame=null,this._originTransform=null,this._originPivot=null},t.HALF_PI=.5*Math.PI,t._pool=[],t}();t.TimelineState=n;var o=function(){function t(){this.loop=0,this.layer=0,this._timelineStates={}}return t._borrowObject=function(){return 0==t._pool.length?new t:t._pool.pop()},t._returnObject=function(i){t._pool.indexOf(i)<0&&(t._pool[t._pool.length]=i),i.clear()},t._clear=function(){for(var i=t._pool.length;i--;)t._pool[i].clear();t._pool.length=0},t.prototype.fadeIn=function(t,i,e,a,s,r,n,o){this.layer=r,this.clip=i,this.name=this.clip.name,this.totalTime=this.clip.duration,this._armature=t,Math.round(this.clip.duration*this.clip.frameRate)<2||1/0==a?(this.timeScale=1,this.currentTime=this.totalTime,this.loop=this.loop>=0?1:-1):(this.timeScale=a,this.currentTime=0,this.loop=s),this._pauseBeforeFadeInComplete=o,this._fadeInTime=e*this.timeScale,this._fadeState=1,this._fadeOutBeginTime=0,this._fadeOutWeight=-1,this._fadeWeight=0,this._fadeIn=!0,this._fadeOut=!1,this.loopCount=-1,this.displayControl=n,this.isPlaying=!0,this.isComplete=!1,this.weight=1,this.blend=!0,this.enabled=!0,this.tweenEnabled=!0,this.updateTimelineStates()},t.prototype.fadeOut=function(t,i){if("undefined"==typeof i&&(i=!1),this._armature&&!(this._fadeOutWeight>=0)){this._fadeState=-1,this._fadeOutWeight=this._fadeWeight,this._fadeOutTime=t*this.timeScale,this._fadeOutBeginTime=this.currentTime,this._fadeOut=!0,this.isPlaying=!i,this.displayControl=!1;for(var e in this._timelineStates)this._timelineStates[e].fadeOut();this.enabled=!0}},t.prototype.play=function(){this.isPlaying=!0},t.prototype.stop=function(){this.isPlaying=!1},t.prototype.getMixingTransform=function(t){return this._mixingTransforms?Number(this._mixingTransforms[t]):-1},t.prototype.addMixingTransform=function(t,i,e){if("undefined"==typeof i&&(i=2),"undefined"==typeof e&&(e=!0),!this.clip||!this.clip.getTimeline(t))throw new Error;if(this._mixingTransforms||(this._mixingTransforms={}),e)for(var a,s,r=this._armature._boneList.length;r--;)a=this._armature._boneList[r],a.name==t&&(s=a),s&&(s==a||s.contains(a))&&(this._mixingTransforms[a.name]=i);else this._mixingTransforms[t]=i;this.updateTimelineStates()},t.prototype.removeMixingTransform=function(t,i){if("undefined"==typeof t&&(t=null),"undefined"==typeof i&&(i=!0),t){if(i)for(var e,a,s=this._armature._boneList.length;s--;)e=this._armature._boneList[s],e.name==t&&(a=e),a&&(a==e||a.contains(e))&&delete this._mixingTransforms[e.name];else delete this._mixingTransforms[t];for(var r in this._mixingTransforms){var n=!0;break}n||(this._mixingTransforms=null)}else this._mixingTransforms=null;this.updateTimelineStates()},t.prototype.advanceTime=function(t){if(!this.enabled)return!1;var i,a;if(this._fadeIn&&(this._fadeIn=!1,this._armature.hasEventListener(e.AnimationEvent.FADE_IN)&&(i=new e.AnimationEvent(e.AnimationEvent.FADE_IN),i.animationState=this,this._armature._eventList.push(i))),this._fadeOut&&(this._fadeOut=!1,this._armature.hasEventListener(e.AnimationEvent.FADE_OUT)&&(i=new e.AnimationEvent(e.AnimationEvent.FADE_OUT),i.animationState=this,this._armature._eventList.push(i))),this.currentTime+=t*this.timeScale,this.isPlaying&&!this.isComplete){var s,r;this._pauseBeforeFadeInComplete?(this._pauseBeforeFadeInComplete=!1,this.isPlaying=!1,s=0,r=Math.floor(s)):(s=this.currentTime/this.totalTime,r=Math.floor(s),r!=this.loopCount&&(-1==this.loopCount&&this._armature.hasEventListener(e.AnimationEvent.START)&&(i=new e.AnimationEvent(e.AnimationEvent.START),i.animationState=this,this._armature._eventList.push(i)),this.loopCount=r,this.loopCount&&(this.loop&&this.loopCount*this.loopCount>=this.loop*this.loop-1?(a=!0,s=1,r=0,this._armature.hasEventListener(e.AnimationEvent.COMPLETE)&&(i=new e.AnimationEvent(e.AnimationEvent.COMPLETE),i.animationState=this,this._armature._eventList.push(i))):this._armature.hasEventListener(e.AnimationEvent.LOOP_COMPLETE)&&(i=new e.AnimationEvent(e.AnimationEvent.LOOP_COMPLETE),i.animationState=this,this._armature._eventList.push(i)))));for(var n in this._timelineStates)this._timelineStates[n].update(s);var o=this.clip.getFrameList();if(o.length>0){for(var l,h=this.totalTime*(s-r),u=!1;!this._currentFrame||h>this._currentFrame.position+this._currentFrame.duration||h<this._currentFrame.position;)u&&this._armature._arriveAtFrame(this._currentFrame,null,this,!0),u=!0,this._currentFrame?(l=o.indexOf(this._currentFrame),l++,l>=o.length&&(l=0),this._currentFrame=o[l]):this._currentFrame=o[0];u&&this._armature._arriveAtFrame(this._currentFrame,null,this,!1)}}if(this._fadeState>0)0==this._fadeInTime?(this._fadeWeight=1,this._fadeState=0,this.isPlaying=!0,this._armature.hasEventListener(e.AnimationEvent.FADE_IN_COMPLETE)&&(i=new e.AnimationEvent(e.AnimationEvent.FADE_IN_COMPLETE),i.animationState=this,this._armature._eventList.push(i))):(this._fadeWeight=this.currentTime/this._fadeInTime,this._fadeWeight>=1&&(this._fadeWeight=1,this._fadeState=0,this.isPlaying||(this.currentTime-=this._fadeInTime),this.isPlaying=!0,this._armature.hasEventListener(e.AnimationEvent.FADE_IN_COMPLETE)&&(i=new e.AnimationEvent(e.AnimationEvent.FADE_IN_COMPLETE),i.animationState=this,this._armature._eventList.push(i))));else if(this._fadeState<0){if(0==this._fadeOutTime)return this._fadeWeight=0,this._fadeState=0,this._armature.hasEventListener(e.AnimationEvent.FADE_OUT_COMPLETE)&&(i=new e.AnimationEvent(e.AnimationEvent.FADE_OUT_COMPLETE),i.animationState=this,this._armature._eventList.push(i)),!0;if(this._fadeWeight=(1-(this.currentTime-this._fadeOutBeginTime)/this._fadeOutTime)*this._fadeOutWeight,this._fadeWeight<=0)return this._fadeWeight=0,this._fadeState=0,this._armature.hasEventListener(e.AnimationEvent.FADE_OUT_COMPLETE)&&(i=new e.AnimationEvent(e.AnimationEvent.FADE_OUT_COMPLETE),i.animationState=this,this._armature._eventList.push(i)),!0}return a&&(this.isComplete=!0,this.loop<0&&this.fadeOut((this._fadeOutWeight||this._fadeInTime)/this.timeScale,!0)),!1},t.prototype.updateTimelineStates=function(){if(this._mixingTransforms){for(var t in this._timelineStates)null==this._mixingTransforms[t]&&this.removeTimelineState(t);for(t in this._mixingTransforms)this._timelineStates[t]||this.addTimelineState(t)}else for(t in this.clip.getTimelines())this._timelineStates[t]||this.addTimelineState(t)},t.prototype.addTimelineState=function(t){var i=this._armature.getBone(t);if(i){var e=n._borrowObject(),a=this.clip.getTimeline(t);e.fadeIn(i,this,a),this._timelineStates[t]=e}},t.prototype.removeTimelineState=function(t){n._returnObject(this._timelineStates[t]),delete this._timelineStates[t]},t.prototype.clear=function(){this.clip=null,this.enabled=!1,this._armature=null,this._currentFrame=null,this._mixingTransforms=null;for(var t in this._timelineStates)this.removeTimelineState(t)},t._pool=[],t}();t.AnimationState=o;var l=function(){function t(t){this._armature=t,this._animationLayer=[],this._isPlaying=!1,this.animationNameList=[],this.tweenEnabled=!0,this.timeScale=1}return t.prototype.getLastAnimationName=function(){return this._lastAnimationState?this._lastAnimationState.name:null},t.prototype.getLastAnimationState=function(){return this._lastAnimationState},t.prototype.getAnimationDataList=function(){return this._animationDataList},t.prototype.setAnimationDataList=function(t){this._animationDataList=t,this.animationNameList.length=0;for(var i in this._animationDataList)this.animationNameList[this.animationNameList.length]=this._animationDataList[i].name},t.prototype.getIsPlaying=function(){return this._isPlaying&&!this.getIsComplete()},t.prototype.getIsComplete=function(){if(this._lastAnimationState){if(!this._lastAnimationState.isComplete)return!1;for(var t=this._animationLayer.length;t--;)for(var i=this._animationLayer[t],e=i.length;e--;)if(!i[e].isComplete)return!1;return!0}return!1},t.prototype.dispose=function(){if(this._armature){this.stop();for(var t=this._animationLayer.length;t--;){for(var i=this._animationLayer[t],e=i.length;e--;)o._returnObject(i[e]);i.length=0}this._animationLayer.length=0,this.animationNameList.length=0,this._armature=null,this._animationLayer=null,this._animationDataList=null,this.animationNameList=null}},t.prototype.gotoAndPlay=function(i,e,a,s,r,n,l,h,u,_){if("undefined"==typeof e&&(e=-1),"undefined"==typeof a&&(a=-1),"undefined"==typeof s&&(s=0/0),"undefined"==typeof r&&(r=0),"undefined"==typeof n&&(n=null),"undefined"==typeof l&&(l=t.SAME_LAYER_AND_GROUP),"undefined"==typeof h&&(h=!0),"undefined"==typeof u&&(u=!0),"undefined"==typeof _&&(_=!0),!this._animationDataList)return null;for(var f,m=this._animationDataList.length;m--;)if(this._animationDataList[m].name==i){f=this._animationDataList[m];break}if(!f)return null;this._isPlaying=!0,e=0>e?f.fadeInTime<0?.3:f.fadeInTime:e;var p;p=0>a?f.scale<0?1:f.scale:a/f.duration,s=isNaN(s)?f.loop:s,r=this.addLayer(r);var d,c;switch(l){case t.NONE:break;case t.SAME_LAYER:for(c=this._animationLayer[r],m=c.length;m--;)d=c[m],d.fadeOut(e,u);break;case t.SAME_GROUP:for(g=this._animationLayer.length;g--;)for(c=this._animationLayer[g],m=c.length;m--;)d=c[m],d.group==n&&d.fadeOut(e,u);break;case t.ALL:for(var g=this._animationLayer.length;g--;)for(c=this._animationLayer[g],m=c.length;m--;)d=c[m],d.fadeOut(e,u);break;case t.SAME_LAYER_AND_GROUP:default:for(c=this._animationLayer[r],m=c.length;m--;)d=c[m],d.group==n&&d.fadeOut(e,u)}this._lastAnimationState=o._borrowObject(),this._lastAnimationState.group=n,this._lastAnimationState.tweenEnabled=this.tweenEnabled,this._lastAnimationState.fadeIn(this._armature,f,e,1/p,s,r,h,_),this.addState(this._lastAnimationState);var y,v,A=this._armature._slotList;for(m=A.length;m--;)y=A[m],v=y.getChildArmature(),v&&v.animation.gotoAndPlay(i,e);return this._lastAnimationState},t.prototype.play=function(){this._animationDataList&&0!=this._animationDataList.length&&(this._lastAnimationState?this._isPlaying?this.gotoAndPlay(this._lastAnimationState.name):this._isPlaying=!0:this.gotoAndPlay(this._animationDataList[0].name))},t.prototype.stop=function(){this._isPlaying=!1},t.prototype.getState=function(t,i){"undefined"==typeof i&&(i=0);var e=this._animationLayer.length;if(0==e)return null;i>=e&&(i=e-1);var a=this._animationLayer[i];if(!a)return null;for(var s=a.length;s--;)if(a[s].name==t)return a[s];return null},t.prototype.hasAnimation=function(t){for(var i=this._animationDataList.length;i--;)if(this._animationDataList[i].name==t)return!0;return!1},t.prototype.advanceTime=function(t){if(this._isPlaying){t*=this.timeScale;var i,e,a,s,r,n,o,l,h,u,_,f,m,p,d,c,g,y,v,A,D,L=this._armature._boneList.length,T=L;for(L--;T--;){for(s=this._armature._boneList[T],r=s.name,n=1,o=0,l=0,h=0,u=0,_=0,f=0,m=0,p=0,i=this._animationLayer.length;i--;){for(d=0,c=this._animationLayer[i],a=c.length,e=0;a>e;e++)g=c[e],T==L&&g.advanceTime(t)?(this.removeState(g),e--,a--):(y=g._timelineStates[r],y&&y.tweenActive&&(v=g._fadeWeight*g.weight*n,A=y.transform,D=y.pivot,o+=A.x*v,l+=A.y*v,h+=A.skewX*v,u+=A.skewY*v,_+=A.scaleX*v,f+=A.scaleY*v,m+=D.x*v,p+=D.y*v,d+=v));if(d>=n)break;n-=d}A=s.tween,D=s._tweenPivot,A.x=o,A.y=l,A.skewX=h,A.skewY=u,A.scaleX=_,A.scaleY=f,D.x=m,D.y=p}}},t.prototype.addLayer=function(t){return t>=this._animationLayer.length&&(t=this._animationLayer.length,this._animationLayer[t]=[]),t},t.prototype.addState=function(t){var i=this._animationLayer[t.layer];i.push(t)},t.prototype.removeState=function(t){var i=t.layer,e=this._animationLayer[i];e.splice(e.indexOf(t),1),o._returnObject(t),0==e.length&&i==this._animationLayer.length-1&&this._animationLayer.length--},t.NONE="none",t.SAME_LAYER="sameLayer",t.SAME_GROUP="sameGroup",t.SAME_LAYER_AND_GROUP="sameLayerAndGroup",t.ALL="all",t}();t.Animation=l}(t.animation||(t.animation={}));var a=t.animation;!function(t){var e=function(){function t(){this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.scaleX=1,this.scaleY=1}return t.prototype.getRotation=function(){return this.skewX},t.prototype.setRotation=function(t){this.skewX=this.skewY=t},t.prototype.copy=function(t){this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY},t.prototype.toString=function(){return"[DBTransform (x="+this.x+" y="+this.y+" skewX="+this.skewX+" skewY="+this.skewY+" scaleX="+this.scaleX+" scaleY="+this.scaleY+")]"},t}();t.DBTransform=e;var a=function(){function t(){this.position=0,this.duration=0}return t.prototype.dispose=function(){},t}();t.Frame=a;var s=function(t){function a(){t.call(this),this.tweenEasing=0,this.tweenRotate=0,this.displayIndex=0,this.zOrder=0/0,this.visible=!0,this.global=new e,this.transform=new e,this.pivot=new i.Point}return __extends(a,t),a.prototype.dispose=function(){t.prototype.dispose.call(this),this.global=null,this.transform=null,this.pivot=null,this.color=null},a}(a);t.TransformFrame=s;var n=function(){function t(){this._frameList=[],this.duration=0,this.scale=1}return t.prototype.getFrameList=function(){return this._frameList},t.prototype.dispose=function(){for(var t=this._frameList.length;t--;)this._frameList[t].dispose();this._frameList.length=0,this._frameList=null},t.prototype.addFrame=function(t){if(!t)throw new Error;if(!(this._frameList.indexOf(t)<0))throw new Error;this._frameList[this._frameList.length]=t},t}();t.Timeline=n;var o=function(t){function a(){t.call(this),this.originTransform=new e,this.originPivot=new i.Point,this.offset=0,this.transformed=!1}return __extends(a,t),a.prototype.dispose=function(){this!=a.HIDE_TIMELINE&&(t.prototype.dispose.call(this),this.originTransform=null,this.originPivot=null)},a.HIDE_TIMELINE=new a,a}(n);t.TransformTimeline=o;var l=function(t){function i(){t.call(this),this.frameRate=0,this.loop=0,this.tweenEasing=0/0,this.fadeInTime=0,this._timelines={}}return __extends(i,t),i.prototype.getTimelines=function(){return this._timelines},i.prototype.dispose=function(){t.prototype.dispose.call(this);for(var i in this._timelines)this._timelines[i].dispose();this._timelines=null},i.prototype.getTimeline=function(t){return this._timelines[t]},i.prototype.addTimeline=function(t,i){if(!t)throw new Error;this._timelines[i]=t},i}(n);t.AnimationData=l;var h=function(){function t(){this.transform=new e}return t.prototype.dispose=function(){this.transform=null,this.pivot=null},t.ARMATURE="armature",t.IMAGE="image",t}();t.DisplayData=h;var u=function(){function t(){this._displayDataList=[],this.zOrder=0}return t.prototype.getDisplayDataList=function(){return this._displayDataList},t.prototype.dispose=function(){for(var t=this._displayDataList.length;t--;)this._displayDataList[t].dispose();this._displayDataList.length=0,this._displayDataList=null},t.prototype.addDisplayData=function(t){if(!t)throw new Error;if(!(this._displayDataList.indexOf(t)<0))throw new Error;this._displayDataList[this._displayDataList.length]=t},t.prototype.getDisplayData=function(t){for(var i=this._displayDataList.length;i--;)if(this._displayDataList[i].name==t)return this._displayDataList[i];return null},t}();t.SlotData=u;var _=function(){function t(){this.length=0,this.global=new e,this.transform=new e}return t.prototype.dispose=function(){this.global=null,this.transform=null},t}();t.BoneData=_;var f=function(){function t(){this._slotDataList=[]}return t.prototype.getSlotDataList=function(){return this._slotDataList},t.prototype.dispose=function(){for(var t=this._slotDataList.length;t--;)this._slotDataList[t].dispose();this._slotDataList.length=0,this._slotDataList=null},t.prototype.getSlotData=function(t){for(var i=this._slotDataList.length;i--;)if(this._slotDataList[i].name==t)return this._slotDataList[i];return null},t.prototype.addSlotData=function(t){if(!t)throw new Error;if(!(this._slotDataList.indexOf(t)<0))throw new Error;this._slotDataList[this._slotDataList.length]=t},t}();t.SkinData=f;var m=function(){function t(){this._boneDataList=[],this._skinDataList=[],this._animationDataList=[]}return t.prototype.getBoneDataList=function(){return this._boneDataList},t.prototype.getSkinDataList=function(){return this._skinDataList},t.prototype.getAnimationDataList=function(){return this._animationDataList},t.prototype.dispose=function(){for(var t=this._boneDataList.length;t--;)this._boneDataList[t].dispose();for(t=this._skinDataList.length;t--;)this._skinDataList[t].dispose();for(t=this._animationDataList.length;t--;)this._animationDataList[t].dispose();this._boneDataList.length=0,this._skinDataList.length=0,this._animationDataList.length=0,this._boneDataList=null,this._skinDataList=null,this._animationDataList=null},t.prototype.getBoneData=function(t){for(var i=this._boneDataList.length;i--;)if(this._boneDataList[i].name==t)return this._boneDataList[i];
return null},t.prototype.getSkinData=function(t){if(!t)return this._skinDataList[0];for(var i=this._skinDataList.length;i--;)if(this._skinDataList[i].name==t)return this._skinDataList[i];return null},t.prototype.getAnimationData=function(t){for(var i=this._animationDataList.length;i--;)if(this._animationDataList[i].name==t)return this._animationDataList[i];return null},t.prototype.addBoneData=function(t){if(!t)throw new Error;if(!(this._boneDataList.indexOf(t)<0))throw new Error;this._boneDataList[this._boneDataList.length]=t},t.prototype.addSkinData=function(t){if(!t)throw new Error;if(!(this._skinDataList.indexOf(t)<0))throw new Error;this._skinDataList[this._skinDataList.length]=t},t.prototype.addAnimationData=function(t){if(!t)throw new Error;this._animationDataList.indexOf(t)<0&&(this._animationDataList[this._animationDataList.length]=t)},t.prototype.sortBoneDataList=function(){var t=this._boneDataList.length;if(0!=t){for(var i=[];t--;){for(var e=this._boneDataList[t],a=0,s=e;s&&s.parent;)a++,s=this.getBoneData(s.parent);i[t]={level:a,boneData:e}}for(i.sort(this.sortBoneData),t=i.length;t--;)this._boneDataList[t]=i[t].boneData}},t.prototype.sortBoneData=function(t,i){return t.level>i.level?1:-1},t}();t.ArmatureData=m;var p=function(){function t(){this._armatureDataList=[],this._subTexturePivots={}}return t.prototype.getArmatureNames=function(){var t=[];for(var i in this._armatureDataList)t[t.length]=this._armatureDataList[i].name;return t},t.prototype.getArmatureDataList=function(){return this._armatureDataList},t.prototype.dispose=function(){for(var t in this._armatureDataList)this._armatureDataList[t].dispose();this._armatureDataList.length=0,this._armatureDataList=null,this._subTexturePivots=null},t.prototype.getArmatureData=function(t){for(var i=this._armatureDataList.length;i--;)if(this._armatureDataList[i].name==t)return this._armatureDataList[i];return null},t.prototype.addArmatureData=function(t){if(!t)throw new Error;if(!(this._armatureDataList.indexOf(t)<0))throw new Error;this._armatureDataList[this._armatureDataList.length]=t},t.prototype.removeArmatureData=function(t){var i=this._armatureDataList.indexOf(t);i>=0&&this._armatureDataList.splice(i,1)},t.prototype.removeArmatureDataByName=function(t){for(var i=this._armatureDataList.length;i--;)this._armatureDataList[i].name==t&&this._armatureDataList.splice(i,1)},t.prototype.getSubTexturePivot=function(t){return this._subTexturePivots[t]},t.prototype.addSubTexturePivot=function(t,e,a){var s=this._subTexturePivots[a];return s?(s.x=t,s.y=e):this._subTexturePivots[a]=s=new i.Point(t,e),s},t.prototype.removeSubTexturePivot=function(t){if(t)delete this._subTexturePivots[t];else for(t in this._subTexturePivots)delete this._subTexturePivots[t]},t}();t.SkeletonData=p;var d=function(){function t(){}return t.parseTextureAtlasData=function(t,e){if("undefined"==typeof e&&(e=1),!t)throw new Error;var a={};a.__name=t[r.ConstValues.A_NAME];var s=t[r.ConstValues.SUB_TEXTURE];for(var n in s){var o=s[n],l=o[r.ConstValues.A_NAME],h=new i.Rectangle(Number(o[r.ConstValues.A_X])/e,Number(o[r.ConstValues.A_Y])/e,Number(o[r.ConstValues.A_WIDTH])/e,Number(o[r.ConstValues.A_HEIGHT])/e);a[l]=h}return a},t.parseSkeletonData=function(i){if(!i)throw new Error;var e=Number(i[r.ConstValues.A_FRAME_RATE]),a=new p;a.name=i[r.ConstValues.A_NAME];var s=i[r.ConstValues.ARMATURE];for(var n in s){var o=s[n];a.addArmatureData(t.parseArmatureData(o,a,e))}return a},t.parseArmatureData=function(i,e,a){var s=new m;s.name=i[r.ConstValues.A_NAME];var n=i[r.ConstValues.BONE];for(var o in n){var l=n[o];s.addBoneData(t.parseBoneData(l))}var h=i[r.ConstValues.SKIN];for(var o in h){var u=h[o];s.addSkinData(t.parseSkinData(u,e))}r.DBDataUtil.transformArmatureData(s),s.sortBoneDataList();var _=i[r.ConstValues.ANIMATION];for(var o in _){var f=_[o];s.addAnimationData(t.parseAnimationData(f,s,a))}return s},t.parseBoneData=function(i){var e=new _;return e.name=i[r.ConstValues.A_NAME],e.parent=i[r.ConstValues.A_PARENT],e.length=Number(i[r.ConstValues.A_LENGTH])||0,t.parseTransform(i[r.ConstValues.TRANSFORM],e.global),e.transform.copy(e.global),e},t.parseSkinData=function(i,e){var a=new f;a.name=i[r.ConstValues.A_NAME];var s=i[r.ConstValues.SLOT];for(var n in s){var o=s[n];a.addSlotData(t.parseSlotData(o,e))}return a},t.parseSlotData=function(i,e){var a=new u;a.name=i[r.ConstValues.A_NAME],a.parent=i[r.ConstValues.A_PARENT],a.zOrder=Number(i[r.ConstValues.A_Z_ORDER]);var s=i[r.ConstValues.DISPLAY];for(var n in s){var o=s[n];a.addDisplayData(t.parseDisplayData(o,e))}return a},t.parseDisplayData=function(i,e){var a=new h;return a.name=i[r.ConstValues.A_NAME],a.type=i[r.ConstValues.A_TYPE],a.pivot=e.addSubTexturePivot(0,0,a.name),t.parseTransform(i[r.ConstValues.TRANSFORM],a.transform,a.pivot),a},t.parseAnimationData=function(i,e,a){var s=new l;if(s.name=i[r.ConstValues.A_NAME],s.frameRate=a,s.loop=Number(i[r.ConstValues.A_LOOP])||0,s.fadeInTime=Number(i[r.ConstValues.A_FADE_IN_TIME]),s.duration=Number(i[r.ConstValues.A_DURATION])/a,s.scale=Number(i[r.ConstValues.A_SCALE]),i.hasOwnProperty(r.ConstValues.A_TWEEN_EASING)){var n=i[r.ConstValues.A_TWEEN_EASING];s.tweenEasing=void 0==n||null==n?0/0:Number(n)}else s.tweenEasing=0/0;t.parseTimeline(i,s,t.parseMainFrame,a);var o,h,u=i[r.ConstValues.TIMELINE];for(var _ in u){var f=u[_];o=t.parseTransformTimeline(f,s.duration,a),h=f[r.ConstValues.A_NAME],s.addTimeline(o,h)}return r.DBDataUtil.addHideTimeline(s,e),r.DBDataUtil.transformAnimationData(s,e),s},t.parseTimeline=function(t,i,e,a){var s,n=0,o=t[r.ConstValues.FRAME];for(var l in o){var h=o[l];s=e(h,a),s.position=n,i.addFrame(s),n+=s.duration}s&&(s.duration=i.duration-s.position)},t.parseTransformTimeline=function(i,e,a){var s=new o;return s.duration=e,t.parseTimeline(i,s,t.parseTransformFrame,a),s.scale=Number(i[r.ConstValues.A_SCALE]),s.offset=Number(i[r.ConstValues.A_OFFSET]),s},t.parseFrame=function(t,i,e){i.duration=Number(t[r.ConstValues.A_DURATION])/e,i.action=t[r.ConstValues.A_ACTION],i.event=t[r.ConstValues.A_EVENT],i.sound=t[r.ConstValues.A_SOUND]},t.parseMainFrame=function(i,e){var s=new a;return t.parseFrame(i,s,e),s},t.parseTransformFrame=function(e,a){var n=new s;if(t.parseFrame(e,n,a),n.visible=1!=Number(e[r.ConstValues.A_HIDE]),e.hasOwnProperty(r.ConstValues.A_TWEEN_EASING)){var o=e[r.ConstValues.A_TWEEN_EASING];n.tweenEasing=void 0==o||null==o?0/0:Number(o)}else n.tweenEasing=0;n.tweenRotate=Number(e[r.ConstValues.A_TWEEN_ROTATE])||0,n.displayIndex=Number(e[r.ConstValues.A_DISPLAY_INDEX])||0,n.zOrder=Number(e[r.ConstValues.A_Z_ORDER])||0,t.parseTransform(e[r.ConstValues.TRANSFORM],n.global,n.pivot),n.transform.copy(n.global);var l=e[r.ConstValues.COLOR_TRANSFORM];return l&&(n.color=new i.ColorTransform,n.color.alphaOffset=Number(l[r.ConstValues.A_ALPHA_OFFSET]),n.color.redOffset=Number(l[r.ConstValues.A_RED_OFFSET]),n.color.greenOffset=Number(l[r.ConstValues.A_GREEN_OFFSET]),n.color.blueOffset=Number(l[r.ConstValues.A_BLUE_OFFSET]),n.color.alphaMultiplier=.01*Number(l[r.ConstValues.A_ALPHA_MULTIPLIER]),n.color.redMultiplier=.01*Number(l[r.ConstValues.A_RED_MULTIPLIER]),n.color.greenMultiplier=.01*Number(l[r.ConstValues.A_GREEN_MULTIPLIER]),n.color.blueMultiplier=.01*Number(l[r.ConstValues.A_BLUE_MULTIPLIER])),n},t.parseTransform=function(t,i,e){"undefined"==typeof e&&(e=null),t&&(i&&(i.x=Number(t[r.ConstValues.A_X]),i.y=Number(t[r.ConstValues.A_Y]),i.skewX=Number(t[r.ConstValues.A_SKEW_X])*r.ConstValues.ANGLE_TO_RADIAN,i.skewY=Number(t[r.ConstValues.A_SKEW_Y])*r.ConstValues.ANGLE_TO_RADIAN,i.scaleX=Number(t[r.ConstValues.A_SCALE_X]),i.scaleY=Number(t[r.ConstValues.A_SCALE_Y])),e&&(e.x=Number(t[r.ConstValues.A_PIVOT_X]),e.y=Number(t[r.ConstValues.A_PIVOT_Y])))},t}();t.DataParser=d}(t.objects||(t.objects={}));var s=t.objects;!function(i){var a=function(i){function e(){i.call(this),this._dataDic={},this._textureAtlasDic={},this._textureAtlasLoadingDic={}}return __extends(e,i),e.prototype.getSkeletonData=function(t){return this._dataDic[t]},e.prototype.addSkeletonData=function(t,i){if(!t)throw new Error;if(i=i||t.name,!i)throw new Error("Unnamed data!");this._dataDic[i],this._dataDic[i]=t},e.prototype.removeSkeletonData=function(t){delete this._dataDic[t]},e.prototype.getTextureAtlas=function(t){return this._textureAtlasDic[t]},e.prototype.addTextureAtlas=function(t,i){if(!t)throw new Error;if(i=i||t.name,!i)throw new Error("Unnamed data!");this._textureAtlasDic[i],this._textureAtlasDic[i]=t},e.prototype.removeTextureAtlas=function(t){delete this._textureAtlasDic[t]},e.prototype.dispose=function(t){if("undefined"==typeof t&&(t=!0),t){for(var i in this._dataDic)this._dataDic[i].dispose();for(var i in this._textureAtlasDic)this._textureAtlasDic[i].dispose()}this._dataDic=null,this._textureAtlasDic=null,this._textureAtlasLoadingDic=null,this._currentDataName=null,this._currentTextureAtlasName=null},e.prototype.buildArmature=function(i,e,a,r,n){if(a){var o=this._dataDic[a];if(o)var l=o.getArmatureData(i)}else for(a in this._dataDic)if(o=this._dataDic[a],l=o.getArmatureData(i))break;if(!l)return null;this._currentDataName=a,this._currentTextureAtlasName=r||a;var h=this._generateArmature();h.name=i;var u,_,f=l.getBoneDataList();for(var m in f)_=f[m],u=new t.Bone,u.name=_.name,u.origin.copy(_.transform),l.getBoneData(_.parent)?h.addChild(u,_.parent):h.addChild(u,null);if(e&&e!=i){var p=o.getArmatureData(e);if(!p)for(a in this._dataDic)if(o=this._dataDic[a],p=o.getArmatureData(e))break}h.animation.setAnimationDataList(p?p.getAnimationDataList():l.getAnimationDataList());var d=l.getSkinData(n);if(!d)throw new Error;var c,g,y,v,A,D,L=[],T=d.getSlotDataList();for(var m in T)if(A=T[m],u=h.getBone(A.parent)){for(D=A.getDisplayDataList(),c=this._generateSlot(),c.name=A.name,c._originZOrder=A.zOrder,c._dislayDataList=D,L.length=0,v=D.length;v--;)switch(g=D[v],g.type){case s.DisplayData.ARMATURE:y=this.buildArmature(g.name,null,this._currentDataName,this._currentTextureAtlasName,null),y&&(L[v]=y);break;case s.DisplayData.IMAGE:default:L[v]=this._generateDisplay(this._textureAtlasDic[this._currentTextureAtlasName],g.name,g.pivot.x,g.pivot.y)}c.setDisplayList(L),c._changeDisplay(0),u.addChild(c)}return h._slotsZOrderChanged=!0,h.advanceTime(0),h},e.prototype.getTextureDisplay=function(t,i,e,a){if(i)var s=this._textureAtlasDic[i];if(!s&&!i)for(i in this._textureAtlasDic){if(s=this._textureAtlasDic[i],s.getRegion(t))break;s=null}if(s){if(isNaN(e)||isNaN(a)){var r=this._dataDic[i];if(r){var n=r.getSubTexturePivot(t);n&&(e=n.x,a=n.y)}}return this._generateDisplay(s,t,e,a)}return null},e.prototype._generateArmature=function(){return null},e.prototype._generateSlot=function(){return null},e.prototype._generateDisplay=function(){return null},e}(e.EventDispatcher);i.BaseFactory=a}(t.factorys||(t.factorys={}));t.factorys;!function(t){var e=function(){function t(){}return t.ANGLE_TO_RADIAN=Math.PI/180,t.DRAGON_BONES="dragonBones",t.ARMATURE="armature",t.SKIN="skin",t.BONE="bone",t.SLOT="slot",t.DISPLAY="display",t.ANIMATION="animation",t.TIMELINE="timeline",t.FRAME="frame",t.TRANSFORM="transform",t.COLOR_TRANSFORM="colorTransform",t.TEXTURE_ATLAS="TextureAtlas",t.SUB_TEXTURE="SubTexture",t.A_VERSION="version",t.A_IMAGE_PATH="imagePath",t.A_FRAME_RATE="frameRate",t.A_NAME="name",t.A_PARENT="parent",t.A_LENGTH="length",t.A_TYPE="type",t.A_FADE_IN_TIME="fadeInTime",t.A_DURATION="duration",t.A_SCALE="scale",t.A_OFFSET="offset",t.A_LOOP="loop",t.A_EVENT="event",t.A_SOUND="sound",t.A_ACTION="action",t.A_HIDE="hide",t.A_TWEEN_EASING="tweenEasing",t.A_TWEEN_ROTATE="tweenRotate",t.A_DISPLAY_INDEX="displayIndex",t.A_Z_ORDER="z",t.A_WIDTH="width",t.A_HEIGHT="height",t.A_X="x",t.A_Y="y",t.A_SKEW_X="skX",t.A_SKEW_Y="skY",t.A_SCALE_X="scX",t.A_SCALE_Y="scY",t.A_PIVOT_X="pX",t.A_PIVOT_Y="pY",t.A_ALPHA_OFFSET="aO",t.A_RED_OFFSET="rO",t.A_GREEN_OFFSET="gO",t.A_BLUE_OFFSET="bO",t.A_ALPHA_MULTIPLIER="aM",t.A_RED_MULTIPLIER="rM",t.A_GREEN_MULTIPLIER="gM",t.A_BLUE_MULTIPLIER="bM",t}();t.ConstValues=e;var r=function(){function t(){}return t.transformPointWithParent=function(i,e){var a=t._helpMatrix;t.transformToMatrix(e,a),a.invert();var s=i.x,r=i.y;i.x=a.a*s+a.c*r+a.tx,i.y=a.d*r+a.b*s+a.ty,i.skewX=t.formatRadian(i.skewX-e.skewX),i.skewY=t.formatRadian(i.skewY-e.skewY)},t.transformToMatrix=function(t,i){i.a=t.scaleX*Math.cos(t.skewY),i.b=t.scaleX*Math.sin(t.skewY),i.c=-t.scaleY*Math.sin(t.skewX),i.d=t.scaleY*Math.cos(t.skewX),i.tx=t.x,i.ty=t.y},t.formatRadian=function(i){return i%=t.DOUBLE_PI,i>Math.PI&&(i-=t.DOUBLE_PI),i<-Math.PI&&(i+=t.DOUBLE_PI),i},t.DOUBLE_PI=2*Math.PI,t._helpMatrix=new i.Matrix,t}();t.TransformUtil=r;var n=function(){function t(){}return t.transformArmatureData=function(t){for(var i,e,a=t.getBoneDataList(),s=a.length;s--;)i=a[s],i.parent&&(e=t.getBoneData(i.parent),e&&(i.transform.copy(i.global),r.transformPointWithParent(i.transform,e.global)))},t.transformArmatureDataAnimations=function(i){for(var e=i.getAnimationDataList(),a=e.length;a--;)t.transformAnimationData(e[a],i)},t.transformAnimationData=function(i,e){for(var a,s,n,o,l,h,u,_,f,m,p=e.getSkinData(null),d=e.getBoneDataList(),c=p.getSlotDataList(),g=d.length;g--;)if(a=d[g],s=i.getTimeline(a.name)){n=null;for(var y in c)if(n=c[y],n.parent==a.name)break;o=a.parent?i.getTimeline(a.parent):null,l=s.getFrameList(),h=null,u=null,_=null,m=l.length;for(var v=0;m>v;v++){if(f=l[v],o?(t._helpTransform1.copy(f.global),t.getTimelineTransform(o,f.position,t._helpTransform2),r.transformPointWithParent(t._helpTransform1,t._helpTransform2),f.transform.copy(t._helpTransform1)):f.transform.copy(f.global),f.transform.x-=a.transform.x,f.transform.y-=a.transform.y,f.transform.skewX-=a.transform.skewX,f.transform.skewY-=a.transform.skewY,f.transform.scaleX-=a.transform.scaleX,f.transform.scaleY-=a.transform.scaleY,s.transformed||n&&(f.zOrder-=n.zOrder),h||(h=s.originTransform,h.copy(f.transform),h.skewX=r.formatRadian(h.skewX),h.skewY=r.formatRadian(h.skewY),u=s.originPivot,u.x=f.pivot.x,u.y=f.pivot.y),f.transform.x-=h.x,f.transform.y-=h.y,f.transform.skewX=r.formatRadian(f.transform.skewX-h.skewX),f.transform.skewY=r.formatRadian(f.transform.skewY-h.skewY),f.transform.scaleX-=h.scaleX,f.transform.scaleY-=h.scaleY,s.transformed||(f.pivot.x-=u.x,f.pivot.y-=u.y),_){var A=f.transform.skewX-_.transform.skewX;_.tweenRotate?_.tweenRotate>0?(0>A&&(f.transform.skewX+=2*Math.PI,f.transform.skewY+=2*Math.PI),_.tweenRotate>1&&(f.transform.skewX+=2*Math.PI*(_.tweenRotate-1),f.transform.skewY+=2*Math.PI*(_.tweenRotate-1))):(A>0&&(f.transform.skewX-=2*Math.PI,f.transform.skewY-=2*Math.PI),_.tweenRotate<1&&(f.transform.skewX+=2*Math.PI*(_.tweenRotate+1),f.transform.skewY+=2*Math.PI*(_.tweenRotate+1))):(f.transform.skewX=_.transform.skewX+r.formatRadian(f.transform.skewX-_.transform.skewX),f.transform.skewY=_.transform.skewY+r.formatRadian(f.transform.skewY-_.transform.skewY))}_=f}s.transformed=!0}},t.getTimelineTransform=function(t,i,e){for(var s,n,o,l,h=t.getFrameList(),u=h.length;u--;)if(s=h[u],s.position<=i&&s.position+s.duration>i){n=s.tweenEasing,u==h.length-1||isNaN(n)||i==s.position?e.copy(s.global):(o=(i-s.position)/s.duration,n&&(o=a.TimelineState.getEaseValue(o,n)),l=h[u+1],e.x=s.global.x+(l.global.x-s.global.x)*o,e.y=s.global.y+(l.global.y-s.global.y)*o,e.skewX=r.formatRadian(s.global.skewX+(l.global.skewX-s.global.skewX)*o),e.skewY=r.formatRadian(s.global.skewY+(l.global.skewY-s.global.skewY)*o),e.scaleX=s.global.scaleX+(l.global.scaleX-s.global.scaleX)*o,e.scaleY=s.global.scaleY+(l.global.scaleY-s.global.scaleY)*o);break}},t.addHideTimeline=function(t,i){for(var e,a,r=i.getBoneDataList(),n=r.length;n--;)e=r[n],a=e.name,t.getTimeline(a)||t.addTimeline(s.TransformTimeline.HIDE_TIMELINE,a)},t._helpTransform1=new s.DBTransform,t._helpTransform2=new s.DBTransform,t}();t.DBDataUtil=n}(t.utils||(t.utils={}));var r=t.utils,n=function(){function t(){this.global=new s.DBTransform,this.origin=new s.DBTransform,this.offset=new s.DBTransform,this.tween=new s.DBTransform,this.tween.scaleX=this.tween.scaleY=0,this._globalTransformMatrix=new i.Matrix,this._visible=!0,this._isColorChanged=!1,this._isDisplayOnStage=!1,this._scaleType=0,this.fixedRotation=!1}return t.prototype.getVisible=function(){return this._visible},t.prototype.setVisible=function(t){this._visible=t},t.prototype._setParent=function(t){this.parent=t},t.prototype._setArmature=function(t){this.armature&&this.armature._removeDBObject(this),this.armature=t,this.armature&&this.armature._addDBObject(this)},t.prototype.dispose=function(){this.parent=null,this.armature=null,this.global=null,this.origin=null,this.offset=null,this.tween=null,this._globalTransformMatrix=null},t.prototype._update=function(){if(this.global.scaleX=(this.origin.scaleX+this.tween.scaleX)*this.offset.scaleX,this.global.scaleY=(this.origin.scaleY+this.tween.scaleY)*this.offset.scaleY,this.parent){var t=this.origin.x+this.offset.x+this.tween.x,i=this.origin.y+this.offset.y+this.tween.y,e=this.parent._globalTransformMatrix;this._globalTransformMatrix.tx=this.global.x=e.a*t+e.c*i+e.tx,this._globalTransformMatrix.ty=this.global.y=e.d*i+e.b*t+e.ty,this.fixedRotation?(this.global.skewX=this.origin.skewX+this.offset.skewX+this.tween.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this.tween.skewY):(this.global.skewX=this.origin.skewX+this.offset.skewX+this.tween.skewX+this.parent.global.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this.tween.skewY+this.parent.global.skewY),this.parent.scaleMode>=this._scaleType&&(this.global.scaleX*=this.parent.global.scaleX,this.global.scaleY*=this.parent.global.scaleY)}else this._globalTransformMatrix.tx=this.global.x=this.origin.x+this.offset.x+this.tween.x,this._globalTransformMatrix.ty=this.global.y=this.origin.y+this.offset.y+this.tween.y,this.global.skewX=this.origin.skewX+this.offset.skewX+this.tween.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this.tween.skewY;this._globalTransformMatrix.a=this.global.scaleX*Math.cos(this.global.skewY),this._globalTransformMatrix.b=this.global.scaleX*Math.sin(this.global.skewY),this._globalTransformMatrix.c=-this.global.scaleY*Math.sin(this.global.skewX),this._globalTransformMatrix.d=this.global.scaleY*Math.cos(this.global.skewX)},t}();t.DBObject=n;var o=function(t){function i(i){t.call(this),this._displayBridge=i,this._displayList=[],this._displayIndex=-1,this._scaleType=1,this._originZOrder=0,this._tweenZorder=0,this._offsetZOrder=0,this._isDisplayOnStage=!1,this._isHideDisplay=!1}return __extends(i,t),i.prototype.getZOrder=function(){return this._originZOrder+this._tweenZorder+this._offsetZOrder},i.prototype.setZOrder=function(t){this.getZOrder()!=t&&(this._offsetZOrder=t-this._originZOrder-this._tweenZorder,this.armature&&(this.armature._slotsZOrderChanged=!0))},i.prototype.getDisplay=function(){var t=this._displayList[this._displayIndex];return t instanceof h?t.getDisplay():t},i.prototype.setDisplay=function(t){this._displayList[this._displayIndex]=t,this._setDisplay(t)},i.prototype.getChildArmature=function(){var t=this._displayList[this._displayIndex];return t instanceof h?t:null},i.prototype.setChildArmature=function(t){this._displayList[this._displayIndex]=t,t&&this._setDisplay(t.getDisplay())},i.prototype.getDisplayList=function(){return this._displayList},i.prototype.setDisplayList=function(t){if(!t)throw new Error;for(var i=this._displayList.length=t.length;i--;)this._displayList[i]=t[i];if(this._displayIndex>=0){var e=this._displayIndex;this._displayIndex=-1,this._changeDisplay(e)}},i.prototype._setDisplay=function(t){this._displayBridge.getDisplay()?this._displayBridge.setDisplay(t):(this._displayBridge.setDisplay(t),this.armature&&(this._displayBridge.addDisplay(this.armature.getDisplay(),-1),this.armature._slotsZOrderChanged=!0)),this.updateChildArmatureAnimation(),this._isDisplayOnStage=!this._isHideDisplay&&this._displayBridge.getDisplay()?!0:!1},i.prototype._changeDisplay=function(t){if(0>t)this._isHideDisplay||(this._isHideDisplay=!0,this._displayBridge.removeDisplay(),this.updateChildArmatureAnimation());else{if(this._isHideDisplay){this._isHideDisplay=!1;var i=!0;this.armature&&(this._displayBridge.addDisplay(this.armature.getDisplay(),-1),this.armature._slotsZOrderChanged=!0)}var e=this._displayList.length;if(t>=e&&e>0&&(t=e-1),this._displayIndex!=t){this._displayIndex=t;var a=this._displayList[this._displayIndex];this._setDisplay(a instanceof h?a.getDisplay():a),this._dislayDataList&&this._displayIndex<=this._dislayDataList.length&&this.origin.copy(this._dislayDataList[this._displayIndex].transform)}else i&&this.updateChildArmatureAnimation()}this._isDisplayOnStage=!this._isHideDisplay&&this._displayBridge.getDisplay()?!0:!1},i.prototype.setVisible=function(t){t!=this._visible&&(this._visible=t,this._updateVisible(this._visible))},i.prototype._setArmature=function(i){t.prototype._setArmature.call(this,i),this.armature?(this.armature._slotsZOrderChanged=!0,this._displayBridge.addDisplay(this.armature.getDisplay(),-1)):this._displayBridge.removeDisplay()},i.prototype.dispose=function(){this._displayBridge&&(t.prototype.dispose.call(this),this._displayBridge.dispose(),this._displayList.length=0,this._displayBridge=null,this._displayList=null,this._dislayDataList=null)},i.prototype._update=function(){if(t.prototype._update.call(this),this._isDisplayOnStage){var i=this.parent._tweenPivot.x,e=this.parent._tweenPivot.y;if(i||e){var a=this.parent._globalTransformMatrix;this._globalTransformMatrix.tx+=a.a*i+a.c*e,this._globalTransformMatrix.ty+=a.b*i+a.d*e}this._displayBridge.updateTransform(this._globalTransformMatrix,this.global)}},i.prototype._updateVisible=function(t){this._displayBridge.setVisible(this.parent.getVisible()&&this._visible&&t)},i.prototype.updateChildArmatureAnimation=function(){var t=this.getChildArmature();if(t)if(this._isHideDisplay)t.animation.stop(),t.animation._lastAnimationState=null;else{var i=this.armature?this.armature.animation.getLastAnimationName():null;i&&t.animation.hasAnimation(i)?t.animation.gotoAndPlay(i):t.animation.play()}},i}(n);t.Slot=o;var l=function(t){function a(){t.call(this),this._children=[],this._scaleType=2,this._tweenPivot=new i.Point,this.scaleMode=1}return __extends(a,t),a.prototype.setVisible=function(t){if(this._visible!=t){this._visible=t;for(var i=this._children.length;i--;){var e=this._children[i];e instanceof o&&e._updateVisible(this._visible)}}},a.prototype._setArmature=function(i){t.prototype._setArmature.call(this,i);for(var e=this._children.length;e--;)this._children[e]._setArmature(this.armature)},a.prototype.dispose=function(){if(this._children){t.prototype.dispose.call(this);for(var i=this._children.length;i--;)this._children[i].dispose();this._children.length=0,this._children=null,this._tweenPivot=null,this.slot=null}},a.prototype.contains=function(t){if(!t)throw new Error;if(t==this)return!1;for(var i=t;i!=this&&null!=i;)i=i.parent;return i==this},a.prototype.addChild=function(t){if(!t)throw new Error;if(t==this||t instanceof a&&t.contains(this))throw new Error("An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)");t.parent&&t.parent.removeChild(t),this._children[this._children.length]=t,t._setParent(this),t._setArmature(this.armature),!this.slot&&t instanceof o&&(this.slot=t)},a.prototype.removeChild=function(t){if(!t)throw new Error;var i=this._children.indexOf(t);if(!(i>=0))throw new Error;this._children.splice(i,1),t._setParent(null),t._setArmature(null),t==this.slot&&(this.slot=null)},a.prototype.getSlots=function(){for(var t=[],i=this._children.length;i--;)this._children[i]instanceof o&&t.unshift(this._children[i]);return t},a.prototype._arriveAtFrame=function(t,i,s){if(t){var r=s.getMixingTransform(name);if(!(!s.displayControl||2!=r&&-1!=r||this.displayController&&this.displayController!=s.name)){var n=t;if(this.slot){var l=n.displayIndex;l>=0&&(isNaN(n.zOrder)||n.zOrder==this.slot._tweenZorder||(this.slot._tweenZorder=n.zOrder,this.armature._slotsZOrderChanged=!0)),this.slot._changeDisplay(l),this.slot._updateVisible(n.visible)}}if(t.event&&this.armature.hasEventListener(e.FrameEvent.BONE_FRAME_EVENT)){var h=new e.FrameEvent(e.FrameEvent.BONE_FRAME_EVENT);h.bone=this,h.animationState=s,h.frameLabel=t.event,this.armature._eventList.push(h)}if(t.sound&&a._soundManager.hasEventListener(e.SoundEvent.SOUND)){var u=new e.SoundEvent(e.SoundEvent.SOUND);u.armature=this.armature,u.animationState=s,u.sound=t.sound,a._soundManager.dispatchEvent(u)}if(t.action)for(var _ in this._children)if(this._children[_]instanceof o){var f=this._children[_].getChildArmature();f&&f.animation.gotoAndPlay(t.action)}}else this.slot&&this.slot._changeDisplay(-1)},a.prototype._updateColor=function(t,i,e,a,s,r,n,o,l){(l||this._isColorChanged)&&this.slot._displayBridge.updateColor(t,i,e,a,s,r,n,o),this._isColorChanged=l},a._soundManager=e.SoundEventManager.getInstance(),a}(n);t.Bone=l;var h=function(t){function i(i){t.call(this),this.animation=new a.Animation(this),this._display=i,this._slotsZOrderChanged=!1,this._slotList=[],this._boneList=[],this._eventList=[]}return __extends(i,t),i.prototype.getDisplay=function(){return this._display},i.prototype.dispose=function(){if(this.animation){this.animation.dispose();for(var t=this._slotList.length;t--;)this._slotList[t].dispose();for(t=this._boneList.length;t--;)this._boneList[t].dispose();this._slotList.length=0,this._boneList.length=0,this._eventList.length=0,this._slotList=null,this._boneList=null,this._eventList=null,this._display=null,this.animation=null}},i.prototype.advanceTime=function(t){this.animation.advanceTime(t),t*=this.animation.timeScale;for(var i=this._boneList.length;i--;)this._boneList[i]._update();i=this._slotList.length;for(var a;i--;)if(a=this._slotList[i],a._update(),a._isDisplayOnStage){var s=a.getChildArmature();s&&s.advanceTime(t)}if(this._slotsZOrderChanged&&(this.updateSlotsZOrder(),this.hasEventListener(e.ArmatureEvent.Z_ORDER_UPDATED)&&this.dispatchEvent(new e.ArmatureEvent(e.ArmatureEvent.Z_ORDER_UPDATED))),this._eventList.length){var r=this._eventList.length;for(i=0;r>i;i++)this.dispatchEvent(this._eventList[i]);this._eventList.length=0}},i.prototype.getSlots=function(t){return"undefined"==typeof t&&(t=!0),t?this._slotList.concat():this._slotList},i.prototype.getBones=function(t){return"undefined"==typeof t&&(t=!0),t?this._boneList.concat():this._boneList},i.prototype.getSlot=function(t){for(var i=this._slotList.length;i--;)if(this._slotList[i].name==t)return this._slotList[i];return null},i.prototype.getSlotByDisplay=function(t){if(t)for(var i=this._slotList.length;i--;)if(this._slotList[i].getDisplay()==t)return this._slotList[i];return null},i.prototype.removeSlot=function(t){if(!t)throw new Error;if(!(this._slotList.indexOf(t)>=0))throw new Error;t.parent.removeChild(t)},i.prototype.removeSlotByName=function(t){if(t){var i=this.getSlot(t);i&&this.removeSlot(i)}},i.prototype.getBone=function(t){for(var i=this._boneList.length;i--;)if(this._boneList[i].name==t)return this._boneList[i];return null},i.prototype.getBoneByDisplay=function(t){var i=this.getSlotByDisplay(t);return i?i.parent:null},i.prototype.removeBone=function(t){if(!t)throw new Error;if(!(this._boneList.indexOf(t)>=0))throw new Error;t.parent?t.parent.removeChild(t):t._setArmature(null)},i.prototype.removeBoneByName=function(t){if(t){var i=this.getBone(t);i&&this.removeBone(i)}},i.prototype.addChild=function(t,i){if(!t)throw new Error;if(i){var e=this.getBone(i);if(!e)throw new Error;e.addChild(t)}else t.parent&&t.parent.removeChild(t),t._setArmature(this)},i.prototype.updateSlotsZOrder=function(){this._slotList.sort(this.sortSlot);for(var t,i=this._slotList.length;i--;)t=this._slotList[i],t._isDisplayOnStage&&t._displayBridge.addDisplay(this._display,-1);this._slotsZOrderChanged=!1},i.prototype._addDBObject=function(t){if(t instanceof o){var i=t;this._slotList.indexOf(i)<0&&(this._slotList[this._slotList.length]=i)}else if(t instanceof l){var e=t;this._boneList.indexOf(e)<0&&(this._boneList[this._boneList.length]=e,this._sortBoneList())}},i.prototype._removeDBObject=function(t){if(t instanceof o){var i=t,e=this._slotList.indexOf(i);e>=0&&this._slotList.splice(e,1)}else if(t instanceof l){var a=t;e=this._boneList.indexOf(a),e>=0&&this._boneList.splice(e,1)}},i.prototype._sortBoneList=function(){var t=this._boneList.length;if(0!=t){for(var i,e,a,s=[];t--;){for(i=0,e=this._boneList[t],a=e;a;)i++,a=a.parent;s[t]={level:i,bone:e}}for(s.sort(this.sortBone),t=s.length;t--;)this._boneList[t]=s[t].bone}},i.prototype._arriveAtFrame=function(t,a,s){if(t.event&&this.hasEventListener(e.FrameEvent.ANIMATION_FRAME_EVENT)){var r=new e.FrameEvent(e.FrameEvent.ANIMATION_FRAME_EVENT);r.animationState=s,r.frameLabel=t.event,this._eventList.push(r)}if(t.sound&&i._soundManager.hasEventListener(e.SoundEvent.SOUND)){var n=new e.SoundEvent(e.SoundEvent.SOUND);n.armature=this,n.animationState=s,n.sound=t.sound,i._soundManager.dispatchEvent(n)}t.action&&s.isPlaying&&this.animation.gotoAndPlay(t.action)},i.prototype.sortSlot=function(t,i){return t.getZOrder()<i.getZOrder()?1:-1},i.prototype.sortBone=function(t,i){return t.level<i.level?1:-1},i._soundManager=e.SoundEventManager.getInstance(),i}(e.EventDispatcher);t.Armature=h}(dragonBones||(dragonBones={}));var dragonBones;!function(t){!function(t){var i=function(){function t(){}return t.prototype.getVisible=function(){return this._display?this._display.visible:!1},t.prototype.setVisible=function(t){this._display&&(this._display.visible=t)},t.prototype.getDisplay=function(){return this._display},t.prototype.setDisplay=function(t){if(this._display!=t){if(this._display){var i=this._display.parent;if(i)var e=this._display.parent.getChildIndex(this._display);this.removeDisplay()}this._display=t,this.addDisplay(i,e)}},t.prototype.dispose=function(){this._display=null},t.prototype.updateTransform=function(t,i){this._display.x=t.tx,this._display.y=t.ty,this._display.rotation=i.skewX,this._display.scaleX=i.scaleX,this._display.scaleY=i.scaleY},t.prototype.updateColor=function(t,i,e,a,s){this._display&&(this._display.alpha=s)},t.prototype.addDisplay=function(t,i){var e=t;e&&this._display&&(0>i||"undefined"==typeof i?e.addChild(this._display):e.addChildAt(this._display,Math.min(i,e.children.length)))},t.prototype.removeDisplay=function(){this._display&&this._display.parent&&this._display.parent.removeChild(this._display)},t.RADIAN_TO_ANGLE=180/Math.PI,t}();t.PhaserDisplayBridge=i}(t.display||(t.display={}));var i=t.display;!function(i){var e=function(){function i(t,i,e){"undefined"==typeof e&&(e=1),this._regions={},this.image=t,this.scale=e,this.atlasId=i.atlasId,this.parseData(i)}return i.prototype.dispose=function(){this.image=null,this._regions=null},i.prototype.getRegion=function(t){return this._regions[t]},i.prototype.parseData=function(i){var e=t.objects.DataParser.parseTextureAtlasData(i,this.scale);this.name=e.__name,delete e.__name;for(var a in e)this._regions[a]=e[a]},i}();i.PhaserBonesAtlas=e}(t.textures||(t.textures={}));t.textures;!function(e){var a=function(e){function a(){e.call(this)}return __extends(a,e),a.prototype._generateArmature=function(){var i=t.game.add.group(),e=new t.Armature(i);return e},a.prototype._generateSlot=function(){var e=new t.Slot(new i.PhaserDisplayBridge);return e},a.prototype._generateDisplay=function(i,e,a,s){var r=i.atlasId,n=new Phaser.Sprite(t.game,0,0,r);return n.animations.loadFrameData(n.game.cache.getFrameData(r)),n.frameName=e+".png",n.anchor.setTo(a/n.width,s/n.height),n},a}(e.BaseFactory);e.PhaserBonesFactory=a}(t.factorys||(t.factorys={}));t.factorys}(dragonBones||(dragonBones={})),dragonBones.makeBonesAtlas=function(t,i,e){var a={};a.name=i,a.SubTexture=[];for(var s,r,n,o,l,h=t.frames,u=e.length,_=h.length,f=!1,m=0;u>m;m++){s=e[m],f=null!==s.match(/.png/i),f?(n=s,s=n.split(".")[0]):n=s+".png";for(var p=0;_>p;p++)if(r=h[p],r.filename===n){l=r.frame,o={name:s},o.x=l.x,o.y=l.y,o.width=l.w,o.height=l.h,a.SubTexture[m]=o;break
}}return a},dragonBones.makePhaserArmature=function(t,i,e,a,s,r,n,o){var l=dragonBones.makeBonesAtlas(s,i,n);l.atlasId=o;var h=new dragonBones.factorys.PhaserBonesFactory;h.addSkeletonData(dragonBones.objects.DataParser.parseSkeletonData(a));var u=new dragonBones.textures.PhaserBonesAtlas(r,l);h.addTextureAtlas(u);var _=h.buildArmature(t,e,i);return _._factory=h,_},Phaser.Plugin.SpriteBones=function(t,i){Phaser.Plugin.call(this,t,i),dragonBones.game=t,t.spritebones=this},Phaser.Plugin.SpriteBones.prototype=Object.create(Phaser.Plugin.prototype),Phaser.Plugin.SpriteBones.prototype.constructor=Phaser.Plugin.SpriteBones,Phaser.Plugin.SpriteBones.prototype.loadAssets=function(t,i,e,a){this.game.load.image(t+"_image",e),this.game.load.json(t+"_atlas",i),this.game.load.atlas(t,e,i),this.game.load.json(t+"_skeleton",a)},Phaser.Plugin.SpriteBones.prototype.addSprite=function(t,i,e,a,s){var r=this.game.cache.getJSON(t+"_skeleton"),n=this.game.cache.getJSON(t+"_atlas"),o=game.cache.getImage(t+"_image"),l=dragonBones.makePhaserArmature(i,e,null,r,n,o,[],t),h=l.getDisplay();return dragonBones.animation.WorldClock.clock.add(l),this._extendSprite(h,l),h.x=a,h.y=s,this.game.world.add(h)},Phaser.Plugin.SpriteBones.prototype._asBitmapData=function(t,i){var e=null;i&&t.loadTexture(i),t._bitmap?(t._bitmap.clear().update(),e=t._bitmap):e=this.game.make.bitmapData(t.width,t.height),e.draw(t,0,0),e.update(),t.loadTexture(e),t._bitmap=e},Phaser.Plugin.SpriteBones.prototype._applyMultiplyBlending=function(t,i,e,a){e=e||0,a=a||0;var s=t._bitmap;s.blendMultiply(),s.draw(i,e,a),s.blendReset()},Phaser.Plugin.SpriteBones.prototype._extendSprite=function(t,i){t._armature=i,t.play=function(){this._armature.animation.play()},t.stop=function(){this._armature.animation.stop()},t.gotoAndPlay=function(t,i,e,a,s,r,n,o,l,h){this._armature.animation.gotoAndPlay(t,i,e,a,s,r,n,o,l,h)}},Phaser.Plugin.SpriteBones.prototype.update=function(){if(this.lastTime){var t=new Date,i=(t-this.lastTime)/1e3;this.lastTime=t,dragonBones.animation.WorldClock.clock.advanceTime(i)}else this.lastTime=new Date};